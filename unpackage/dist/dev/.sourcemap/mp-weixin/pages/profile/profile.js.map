{"version":3,"file":"profile.js","sources":["pages/profile/profile.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcHJvZmlsZS9wcm9maWxlLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"page\">\n\t\t<!-- 顶部个人信息展示 -->\n\t\t<view class=\"profile-card\">\n\t\t\t<image class=\"avatar\" :src=\"avatar\" mode=\"aspectFill\" />\n\t\t\t<view class=\"profile-info\">\n\t\t\t\t<text class=\"name\">{{ nickname || '未命名用户' }}</text>\n\t\t\t</view>\n\t\t\t<!-- 清除数据按钮（测试用） -->\n\t\t\t<view class=\"clear-btn\" @click=\"clearUserData\">清除登录</view>\n\t\t</view>\n\n\t\t<!-- 数据卡片（仅展示） -->\n\t\t<view class=\"stats-card\">\n\t\t\t<view class=\"stats-title\">挑战数据</view>\n\t\t\t<view class=\"stats-row\">\n\t\t\t\t<view class=\"stat-item\">\n\t\t\t\t\t<text class=\"stat-value\">{{ stats.totalGames }}</text>\n\t\t\t\t\t<text class=\"stat-label\">总挑战</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"stat-item\">\n\t\t\t\t\t<text class=\"stat-value\">{{ stats.successCount }}</text>\n\t\t\t\t\t<text class=\"stat-label\">成功次数</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"stat-item\">\n\t\t\t\t\t<text class=\"stat-value\">{{ stats.successRate }}%</text>\n\t\t\t\t\t<text class=\"stat-label\">成功率</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"stat-item\">\n\t\t\t\t\t<text class=\"stat-value\">{{ stats.uniqueScenes }}</text>\n\t\t\t\t\t<text class=\"stat-label\">玩过场景</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 挑战记录（展示） -->\n\t\t<view class=\"records-card\">\n\t\t\t<view class=\"records-title\">最近挑战</view>\n\t\t\t<view v-if=\"records.length === 0\" class=\"empty\">暂无记录</view>\n\t\t\t<view\n\t\t\t\tv-else\n\t\t\t\tclass=\"record-item\"\n\t\t\t\tv-for=\"(rec, idx) in records\"\n\t\t\t\t:key=\"idx\"\n\t\t\t\t@click=\"handleRecordClick(rec)\"\n\t\t\t>\n\t\t\t\t<view class=\"record-main\">\n\t\t\t\t\t<view class=\"rec-top\">\n\t\t\t\t\t\t<text class=\"rec-title\">{{ rec.sceneTitle || '未知场景' }}</text>\n\t\t\t\t\t\t<text class=\"rec-result\" :class=\"rec.is_success ? 'ok' : 'fail'\">\n\t\t\t\t\t\t\t{{ rec.is_success ? '成功' : '失败' }}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"rec-sub\">\n\t\t\t\t\t\t<text>原谅值：{{ rec.final_forgiveness ?? '--' }}</text>\n\t\t\t\t\t\t<text>轮次：{{ rec.interaction_count ?? '--' }}</text>\n\t\t\t\t\t\t<text>{{ rec.created_at ? rec.created_at.split('T')[0] : '' }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"rec-action\">\n\t\t\t\t\t<text class=\"rec-cta\">再挑战</text>\n\t\t\t\t\t<text class=\"rec-arrow\">›</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 底部选择弹窗 -->\n\t\t<view v-if=\"showBottomSheet\" class=\"bottom-sheet-mask\" @click=\"closeBottomSheet\">\n\t\t\t<view class=\"bottom-sheet\" @click.stop>\n\t\t\t\t<view class=\"sheet-title\">{{ bottomSheetTitle }}</view>\n\t\t\t\t<view class=\"sheet-options\">\n\t\t\t\t\t<view \n\t\t\t\t\t\tv-for=\"(option, index) in bottomSheetOptions\" \n\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\tclass=\"sheet-option\"\n\t\t\t\t\t\t@click=\"handleBottomOption(index)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<image v-if=\"option.avatar\" class=\"option-avatar\" :src=\"option.avatar\" mode=\"aspectFill\" />\n\t\t\t\t\t\t<text class=\"option-text\">{{ option.text }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"sheet-cancel\" @click=\"closeBottomSheet\">取消</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 输入昵称弹窗 -->\n\t\t<view v-if=\"showNameInput\" class=\"modal-mask\" @click=\"closeNameInput\">\n\t\t\t<view class=\"modal\" @click.stop>\n\t\t\t\t<view class=\"modal-title\">输入昵称</view>\n\t\t\t\t<input class=\"modal-input\" v-model=\"inputName\" placeholder=\"请输入昵称\" maxlength=\"20\" />\n\t\t\t\t<view class=\"modal-actions\">\n\t\t\t\t\t<button size=\"mini\" @click=\"closeNameInput\">取消</button>\n\t\t\t\t\t<button size=\"mini\" type=\"primary\" @click=\"confirmNameInput\">确认</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<view class=\"bottom-space\" />\n\t</view>\n</template>\n\n<script>\nimport { gameRecordService, userService } from '@/utils/supabase-helper.js'\n\nexport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tuserId: '',\n\t\t\t\twxOpenid: '',\n\t\t\t\tnickname: '',\n\t\t\t\tavatar: '/static/user.png',\n\t\t\t\tstats: {\n\t\t\t\t\ttotalGames: 0,\n\t\t\t\t\tsuccessCount: 0,\n\t\t\t\t\tsuccessRate: 0,\n\t\t\t\t\tuniqueScenes: 0\n\t\t\t\t},\n\t\t\t\trecords: [],\n\t\t\t\tshowBottomSheet: false,\n\t\t\t\tbottomSheetTitle: '',\n\t\t\t\tbottomSheetOptions: [],\n\t\t\tselectedAvatar: '', // 已选择的头像\n\t\t\tshowNameInput: false,\n\t\t\tinputName: '',\n\t\t\tloginType: 'guest' // 登录类型：wx 或 guest\n\t\t\t}\n\t\t},\n\tonShow() {\n\t\tthis.loadUser()\n\t\tthis.loadStats()\n\t\tthis.loadRecords()\n\t\tif (!this.userId || !this.nickname || !this.avatar) {\n\t\t\tthis.promptLogin()\n\t\t}\n\t},\n\tmethods: {\n\t\tloadUser() {\n\t\t\tconst storedId = uni.getStorageSync('userId') || ''\n\t\t\tconst storedName = uni.getStorageSync('userName') || ''\n\t\t\tconst storedAvatar = uni.getStorageSync('userAvatar') || ''\n\t\t\tconst storedWxOpenid = uni.getStorageSync('wxOpenid') || ''\n\t\t\t// 优先使用已存的 openid 作为 userId，确保身份稳定\n\t\t\tthis.userId = storedWxOpenid || storedId || this.genAnonId()\n\t\t\tthis.wxOpenid = storedWxOpenid || ''\n\t\t\tthis.nickname = storedName || ''\n\t\t\tif (storedAvatar) this.avatar = storedAvatar\n\t\t},\n\t\tasync saveUser(extra = {}) {\n\t\t\t// 保存到本地存储\n\t\t\tconst finalUserId = this.wxOpenid || this.userId || this.genAnonId()\n\t\t\tuni.setStorageSync('userId', finalUserId)\n\t\t\tuni.setStorageSync('userName', this.nickname || '')\n\t\t\tuni.setStorageSync('userAvatar', this.avatar || '/static/user.png')\n\t\t\tuni.setStorageSync('loginType', this.loginType || 'guest')\n\t\t\tif (extra.wxOpenid || this.wxOpenid) {\n\t\t\t\tuni.setStorageSync('wxOpenid', extra.wxOpenid || this.wxOpenid)\n\t\t\t}\n\t\t\t\n\t\t\t// 保存到 Supabase 数据库\n\t\t\ttry {\n\t\t\t\tconst { data, error } = await userService.createOrUpdateUser({\n\t\t\t\t\tuserId: finalUserId,\n\t\t\t\t\tnickname: this.nickname,\n\t\t\t\t\tavatarUrl: this.avatar !== '/static/user.png' ? this.avatar : null,\n\t\t\t\t\tloginType: this.loginType || 'guest',\n\t\t\t\t\twxOpenid: extra.wxOpenid || this.wxOpenid || null\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tif (error) {\n\t\t\t\t\tconsole.error('保存用户信息到数据库失败:', error)\n\t\t\t\t\t// 即使数据库保存失败，本地存储已成功，仍然提示成功\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('保存用户信息异常:', err)\n\t\t\t}\n\t\t\t\n\t\t\tuni.showToast({ title: '已保存', icon: 'success' })\n\t\t},\n\t\tgenAnonId() {\n\t\t\tconst id = `guest-${Math.random().toString(16).slice(2, 10)}`\n\t\t\tthis.userId = id\n\t\t\treturn id\n\t\t},\n\t\tpromptLogin() {\n\t\t\tthis.bottomSheetTitle = '选择登录方式'\n\t\t\tthis.bottomSheetOptions = [\n\t\t\t\t{ text: '微信授权登录', type: 'wx' },\n\t\t\t\t{ text: '手动填写', type: 'manual' }\n\t\t\t]\n\t\t\tthis.showBottomSheet = true\n\t\t},\n\t\thandleBottomOption(index) {\n\t\t\tconst option = this.bottomSheetOptions[index]\n\t\t\tif (option.type === 'wx') {\n\t\t\t\tthis.wxAuthorize()\n\t\t\t\tthis.closeBottomSheet()\n\t\t\t} else if (option.type === 'manual') {\n\t\t\t\t// 切换到手动填写选项\n\t\t\t\tthis.showManualOptions()\n\t\t\t} else if (option.type === 'avatar') {\n\t\t\t\tthis.chooseAvatarFromAlbum()\n\t\t\t} else if (option.type === 'name') {\n\t\t\t\tthis.closeBottomSheet()\n\t\t\t\tthis.showNameInput = true\n\t\t\t}\n\t\t},\n\t\tshowManualOptions() {\n\t\t\tthis.bottomSheetTitle = '手动填写资料'\n\t\t\tthis.bottomSheetOptions = [\n\t\t\t\t{ \n\t\t\t\t\ttext: this.selectedAvatar ? '已选择头像' : '从相册选择头像', \n\t\t\t\t\ttype: 'avatar',\n\t\t\t\t\tavatar: this.selectedAvatar || null\n\t\t\t\t},\n\t\t\t\t{ text: '输入昵称', type: 'name' }\n\t\t\t]\n\t\t\t// 不关闭，直接更新选项\n\t\t},\n\t\tcloseBottomSheet() {\n\t\t\tthis.showBottomSheet = false\n\t\t\tthis.bottomSheetTitle = ''\n\t\t\tthis.bottomSheetOptions = []\n\t\t},\n\t\twxAuthorize() {\n\t\t\t// #ifdef MP-WEIXIN\n\t\t\tthis.wxAuthorizeAndBind()\n\t\t\t// #endif\n\t\t\t// #ifndef MP-WEIXIN\n\t\t\tuni.showToast({ title: '仅支持微信小程序', icon: 'none' })\n\t\t\t// #endif\n\t\t},\n\t\t// 微信授权 + 云函数 login 获取 openid + 同步到数据库\n\t\tasync wxAuthorizeAndBind() {\n\t\t\ttry {\n\t\t\t\tconst profile = await new Promise((resolve, reject) => {\n\t\t\t\t\tuni.getUserProfile({\n\t\t\t\t\t\tdesc: '用于完善个人资料',\n\t\t\t\t\t\tsuccess: (res) => resolve(res.userInfo || {}),\n\t\t\t\t\t\tfail: reject\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\t\tconst openid = await this.ensureWxOpenid()\n\t\t\t\tthis.wxOpenid = openid\n\t\t\t\t// 使用 openid 作为 userId，避免重复记录\n\t\t\t\tthis.userId = openid\n\t\t\t\tthis.nickname = profile.nickName || this.nickname\n\t\t\t\tthis.avatar = profile.avatarUrl || this.avatar\n\t\t\t\tthis.loginType = 'wx'\n\n\t\t\t\tawait this.saveUser({ wxOpenid: openid })\n\t\t\t\tthis.closeBottomSheet()\n\t\t\t\tuni.showToast({ title: '登录成功', icon: 'success' })\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('微信授权失败', err)\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: err?.errMsg || '授权失败',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\t// 调用云函数 login 获取 openid\n\t\tgetWxOpenid() {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t// #ifdef MP-WEIXIN\n\t\t\t\tif (!wx.cloud) {\n\t\t\t\t\treject(new Error('wx.cloud 未初始化'))\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\twx.cloud.callFunction({\n\t\t\t\t\tname: 'login',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tconst openid = res?.result?.openid\n\t\t\t\t\t\tif (openid) resolve(openid)\n\t\t\t\t\t\telse reject(new Error('未获取到 openid'))\n\t\t\t\t\t},\n\t\t\t\t\tfail: reject\n\t\t\t\t})\n\t\t\t\t// #endif\n\t\t\t\t// #ifndef MP-WEIXIN\n\t\t\t\treject(new Error('仅支持微信小程序'))\n\t\t\t\t// #endif\n\t\t\t})\n\t\t},\n\t\t// 确保拿到 openid；拿不到时回退为 guest\n\t\tasync ensureWxOpenid() {\n\t\t\tif (this.wxOpenid) return this.wxOpenid\n\t\t\ttry {\n\t\t\t\tconst openid = await this.getWxOpenid()\n\t\t\t\tthis.wxOpenid = openid\n\t\t\t\tthis.userId = openid\n\t\t\t\tthis.loginType = 'wx'\n\t\t\t\tuni.setStorageSync('wxOpenid', openid)\n\t\t\t\treturn openid\n\t\t\t} catch (err) {\n\t\t\t\t// 无法获取 openid 时回退 guest，但会造成新用户；日志提示\n\t\t\t\tconsole.warn('获取 openid 失败，回退 guest：', err)\n\t\t\t\tthis.loginType = 'guest'\n\t\t\t\treturn null\n\t\t\t}\n\t\t},\n\t\tchangeAvatar() {\n\t\t\t// 个人中心页面头像不可点击编辑\n\t\t},\n\t\tasync chooseAvatarFromAlbum() {\n\t\t\tuni.chooseImage({\n\t\t\t\tcount: 1,\n\t\t\t\tsizeType: ['compressed'],\n\t\t\t\tsourceType: ['album'],\n\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\tif (res.tempFilePaths && res.tempFilePaths.length > 0) {\n\t\t\t\t\t\tthis.selectedAvatar = res.tempFilePaths[0]\n\t\t\t\t\t\tthis.avatar = res.tempFilePaths[0]\n\t\t\t\t\t\t// 更新底部选择中的头像显示\n\t\t\t\t\t\tthis.showManualOptions()\n\t\t\t\t\t\t// 如果昵称也有了，自动保存并关闭\n\t\t\t\t\t\tif (this.nickname) {\n\t\t\t\t\t\t\tconst openid = await this.ensureWxOpenid()\n\t\t\t\t\t\t\tif (openid) {\n\t\t\t\t\t\t\t\tthis.userId = openid\n\t\t\t\t\t\t\t\tthis.loginType = 'wx'\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.loginType = 'guest'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tawait this.saveUser({ wxOpenid: openid || null })\n\t\t\t\t\t\t\tthis.closeBottomSheet()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 头像已选，提示填写昵称\n\t\t\t\t\t\t\tuni.showToast({ title: '头像已选择，请填写昵称', icon: 'none' })\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tcloseNameInput() {\n\t\t\tthis.showNameInput = false\n\t\t\tthis.inputName = ''\n\t\t},\n\t\tasync confirmNameInput() {\n\t\t\tif (!this.inputName.trim()) {\n\t\t\t\tuni.showToast({ title: '请输入昵称', icon: 'none' })\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.nickname = this.inputName.trim()\n\t\t\t// 尝试获取 openid，让手动填写也绑定同一身份\n\t\t\tconst openid = await this.ensureWxOpenid()\n\t\t\tif (openid) {\n\t\t\t\tthis.userId = openid\n\t\t\t\tthis.loginType = 'wx'\n\t\t\t} else {\n\t\t\t\tthis.loginType = 'guest'\n\t\t\t}\n\t\t\t// 如果头像也有了，自动保存\n\t\t\tif (this.selectedAvatar) {\n\t\t\t\tthis.avatar = this.selectedAvatar\n\t\t\t\tawait this.saveUser({ wxOpenid: openid || null })\n\t\t\t} else {\n\t\t\t\t// 昵称已填，提示选择头像\n\t\t\t\tuni.showToast({ title: '昵称已保存，请选择头像', icon: 'none' })\n\t\t\t\t// 重新打开底部选择，显示手动填写选项\n\t\t\t\tthis.showManualOptions()\n\t\t\t\tthis.showBottomSheet = true\n\t\t\t}\n\t\t\tthis.closeNameInput()\n\t\t},\n\t\tasync loadStats() {\n\t\t\tif (!this.userId) return\n\t\t\tconst { data, error } = await gameRecordService.getUserStats(this.userId)\n\t\t\tif (!error && data) {\n\t\t\t\tthis.stats = data\n\t\t\t}\n\t\t},\n\t\tasync loadRecords() {\n\t\t\tif (!this.userId) return\n\t\t\tconst { data, error } = await gameRecordService.getRecentScenes(this.userId, 5)\n\t\t\tif (!error && data) {\n\t\t\t\tthis.records = data.map(r => ({\n\t\t\t\t\t...r,\n\t\t\t\t\tsceneTitle: (r.scene && r.scene.title) || r.scene_title || r.sceneId || '场景'\n\t\t\t\t}))\n\t\t\t}\n\t\t},\n\t\thandleRecordClick(rec) {\n\t\t\tconst sceneId = rec.scene_id || rec.sceneId\n\t\t\tif (!sceneId) {\n\t\t\t\tuni.showToast({ title: '缺少场景ID', icon: 'none' })\n\t\t\t\treturn\n\t\t\t}\n\t\t\tuni.navigateTo({ url: `/pages/dialog/dialog?id=${sceneId}` })\n\t\t},\n\t\tclearUserData() {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '提示',\n\t\t\t\tcontent: '确定要清除登录信息吗？清除后需要重新登录',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t// 清除本地存储\n\t\t\t\t\tuni.removeStorageSync('userId')\n\t\t\t\t\tuni.removeStorageSync('userName')\n\t\t\t\t\tuni.removeStorageSync('userAvatar')\n\t\t\t\t\tuni.removeStorageSync('loginType')\n\t\t\t\t\tuni.removeStorageSync('wxOpenid')\n\t\t\t\t\t// 重置数据\n\t\t\t\t\tthis.userId = ''\n\t\t\t\t\tthis.wxOpenid = ''\n\t\t\t\t\tthis.nickname = ''\n\t\t\t\t\tthis.avatar = '/static/user.png'\n\t\t\t\t\tthis.selectedAvatar = ''\n\t\t\t\t\tthis.loginType = 'guest'\n\t\t\t\t\tthis.stats = {\n\t\t\t\t\t\ttotalGames: 0,\n\t\t\t\t\t\tsuccessCount: 0,\n\t\t\t\t\t\tsuccessRate: 0,\n\t\t\t\t\t\tuniqueScenes: 0\n\t\t\t\t\t}\n\t\t\t\t\tthis.records = []\n\t\t\t\t\t// 弹出登录选择\n\t\t\t\t\tthis.promptLogin()\n\t\t\t\t\tuni.showToast({ title: '已清除，请重新登录', icon: 'success' })\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n}\n</script>\n\n<style>\n.page {\n\tmin-height: 100vh;\n\tbackground: #f5f6fa;\n\tpadding: 20rpx 20rpx 40rpx 20rpx;\n\tbox-sizing: border-box;\n}\n\n.profile-card {\n\tbackground: #fff;\n\tborder-radius: 0;\n\tpadding: 30rpx 24rpx;\n\tmargin-bottom: 20rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tposition: relative;\n}\n\n.avatar {\n\twidth: 120rpx;\n\theight: 120rpx;\n\tborder-radius: 12rpx;\n\tbackground: #f0f0f0;\n\tmargin-right: 24rpx;\n\tflex-shrink: 0;\n}\n\n.profile-info {\n\tflex: 1;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.name {\n\tfont-size: 36rpx;\n\tfont-weight: 500;\n\tcolor: #333;\n}\n\n.clear-btn {\n\tposition: absolute;\n\ttop: 30rpx;\n\tright: 24rpx;\n\tpadding: 8rpx 16rpx;\n\tbackground: #f5f5f5;\n\tborder: 1rpx solid #e0e0e0;\n\tborder-radius: 8rpx;\n\tfont-size: 22rpx;\n\tcolor: #666;\n}\n\n.mini-btn {\n\tbackground: #1f2937;\n\tcolor: #fefefe;\n\tborder: 1rpx solid #2d3748;\n}\n\n.profile-actions {\n\tmargin-top: 16rpx;\n\tdisplay: flex;\n\tgap: 12rpx;\n}\n\n.action-btn {\n\tflex: 1;\n\tborder: 1rpx solid #2d3748;\n\tbackground: #1f2937;\n\tcolor: #fefefe;\n}\n\n.stats-card,\n.records-card {\n\tbackground: #fff;\n\tborder-radius: 16rpx;\n\tpadding: 20rpx;\n\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.04);\n\tmargin-bottom: 16rpx;\n}\n\n.stats-title,\n.records-title {\n\tfont-size: 30rpx;\n\tfont-weight: 600;\n\tcolor: #222;\n\tmargin-bottom: 12rpx;\n}\n\n.stats-row {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\tgap: 12rpx;\n}\n\n.stat-item {\n\tflex: 1;\n\tbackground: #f8f9fb;\n\tborder-radius: 12rpx;\n\tpadding: 16rpx;\n\ttext-align: center;\n}\n\n.stat-value {\n\tfont-size: 32rpx;\n\tfont-weight: 700;\n\tcolor: #111;\n\tdisplay: block;\n\tmargin-bottom: 4rpx;\n}\n\n.stat-label {\n\tfont-size: 24rpx;\n\tcolor: #777;\n}\n\n.record-item {\n\tpadding: 20rpx 16rpx;\n\tborder: 1rpx solid #eef1f5;\n\tborder-radius: 14rpx;\n\tbackground: linear-gradient(180deg, #ffffff 0%, #f9fbff 100%);\n\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.04);\n\tmargin-bottom: 14rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 16rpx;\n}\n\n.rec-top {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tmargin-bottom: 6rpx;\n\tgap: 12rpx;\n}\n\n.rec-title {\n\tfont-size: 28rpx;\n\tcolor: #222;\n\tfont-weight: 600;\n\tflex: 1;\n}\n\n.rec-result {\n\tfont-size: 24rpx;\n\tpadding: 4rpx 10rpx;\n\tborder-radius: 10rpx;\n\twhite-space: nowrap;\n}\n\n.rec-result.ok {\n\tbackground: #e6f6ef;\n\tcolor: #0f9d58;\n}\n\n.rec-result.fail {\n\tbackground: #fdecec;\n\tcolor: #d93025;\n}\n\n.rec-sub {\n\tfont-size: 24rpx;\n\tcolor: #777;\n\tdisplay: flex;\n\tgap: 20rpx;\n\tflex-wrap: wrap;\n}\n\n.empty {\n\tfont-size: 26rpx;\n\tcolor: #999;\n\tpadding: 12rpx 0;\n}\n\n.record-main {\n\tflex: 1;\n\tmin-width: 0;\n}\n\n.rec-action {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 6rpx;\n\tcolor: #4f46e5;\n\tfont-size: 26rpx;\n\tfont-weight: 600;\n\tpadding-left: 8rpx;\n}\n\n.rec-cta {\n\tline-height: 1;\n}\n\n.rec-arrow {\n\tfont-size: 32rpx;\n\tline-height: 1;\n}\n\n.bottom-space {\n\theight: 60rpx;\n}\n\n/* 底部选择弹窗 */\n.bottom-sheet-mask {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground: rgba(0, 0, 0, 0.5);\n\tz-index: 999;\n\tdisplay: flex;\n\talign-items: flex-end;\n}\n\n.bottom-sheet {\n\twidth: 100%;\n\tbackground: #fff;\n\tborder-radius: 24rpx 24rpx 0 0;\n\tpadding: 20rpx 0;\n\tanimation: slideUp 0.3s ease-out;\n}\n\n@keyframes slideUp {\n\tfrom {\n\t\ttransform: translateY(100%);\n\t}\n\tto {\n\t\ttransform: translateY(0);\n\t}\n}\n\n.sheet-title {\n\tfont-size: 28rpx;\n\tcolor: #999;\n\ttext-align: center;\n\tpadding: 0 20rpx 20rpx;\n}\n\n.sheet-options {\n\tpadding: 0 20rpx;\n}\n\n.sheet-option {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 24rpx 0;\n\tborder-bottom: 1rpx solid #f0f0f0;\n}\n\n.sheet-option:last-child {\n\tborder-bottom: none;\n}\n\n.option-avatar {\n\twidth: 60rpx;\n\theight: 60rpx;\n\tborder-radius: 8rpx;\n\tmargin-right: 20rpx;\n}\n\n.option-text {\n\tfont-size: 32rpx;\n\tcolor: #333;\n}\n\n.sheet-cancel {\n\ttext-align: center;\n\tpadding: 24rpx 0;\n\tmargin-top: 20rpx;\n\tborder-top: 1rpx solid #f0f0f0;\n\tfont-size: 32rpx;\n\tcolor: #333;\n}\n\n/* 输入昵称弹窗 */\n.modal-mask {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground: rgba(0, 0, 0, 0.5);\n\tz-index: 1000;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n\n.modal {\n\twidth: 600rpx;\n\tbackground: #fff;\n\tborder-radius: 16rpx;\n\tpadding: 40rpx;\n}\n\n.modal-title {\n\tfont-size: 32rpx;\n\tfont-weight: 600;\n\tcolor: #333;\n\tmargin-bottom: 30rpx;\n\ttext-align: center;\n}\n\n.modal-input {\n\twidth: 100%;\n\tpadding: 20rpx;\n\tborder: 1rpx solid #e0e0e0;\n\tborder-radius: 8rpx;\n\tfont-size: 28rpx;\n\tmargin-bottom: 30rpx;\n}\n\n.modal-actions {\n\tdisplay: flex;\n\tgap: 20rpx;\n\tjustify-content: flex-end;\n}\n</style>\n\n","import MiniProgramPage from 'D:/Hbuilder/HBuilderX.4.76.2025082103/project/first/pages/profile/profile.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","userService","wx","gameRecordService"],"mappings":";;;AAwGA,MAAK,YAAU;AAAA,EACb,OAAO;AACN,WAAO;AAAA,MACN,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,UAAU;AAAA,MACV,QAAQ;AAAA,MACR,OAAO;AAAA,QACN,YAAY;AAAA,QACZ,cAAc;AAAA,QACd,aAAa;AAAA,QACb,cAAc;AAAA,MACd;AAAA,MACD,SAAS,CAAE;AAAA,MACX,iBAAiB;AAAA,MACjB,kBAAkB;AAAA,MAClB,oBAAoB,CAAE;AAAA,MACvB,gBAAgB;AAAA;AAAA,MAChB,eAAe;AAAA,MACf,WAAW;AAAA,MACX,WAAW;AAAA;AAAA,IACX;AAAA,EACA;AAAA,EACF,SAAS;AACR,SAAK,SAAS;AACd,SAAK,UAAU;AACf,SAAK,YAAY;AACjB,QAAI,CAAC,KAAK,UAAU,CAAC,KAAK,YAAY,CAAC,KAAK,QAAQ;AACnD,WAAK,YAAY;AAAA,IAClB;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,WAAW;AACV,YAAM,WAAWA,cAAG,MAAC,eAAe,QAAQ,KAAK;AACjD,YAAM,aAAaA,cAAG,MAAC,eAAe,UAAU,KAAK;AACrD,YAAM,eAAeA,cAAG,MAAC,eAAe,YAAY,KAAK;AACzD,YAAM,iBAAiBA,cAAG,MAAC,eAAe,UAAU,KAAK;AAEzD,WAAK,SAAS,kBAAkB,YAAY,KAAK,UAAU;AAC3D,WAAK,WAAW,kBAAkB;AAClC,WAAK,WAAW,cAAc;AAC9B,UAAI;AAAc,aAAK,SAAS;AAAA,IAChC;AAAA,IACD,MAAM,SAAS,QAAQ,IAAI;AAE1B,YAAM,cAAc,KAAK,YAAY,KAAK,UAAU,KAAK,UAAU;AACnEA,0BAAI,eAAe,UAAU,WAAW;AACxCA,oBAAAA,MAAI,eAAe,YAAY,KAAK,YAAY,EAAE;AAClDA,oBAAAA,MAAI,eAAe,cAAc,KAAK,UAAU,kBAAkB;AAClEA,oBAAAA,MAAI,eAAe,aAAa,KAAK,aAAa,OAAO;AACzD,UAAI,MAAM,YAAY,KAAK,UAAU;AACpCA,sBAAG,MAAC,eAAe,YAAY,MAAM,YAAY,KAAK,QAAQ;AAAA,MAC/D;AAGA,UAAI;AACH,cAAM,EAAE,MAAM,MAAQ,IAAE,MAAMC,qBAAAA,YAAY,mBAAmB;AAAA,UAC5D,QAAQ;AAAA,UACR,UAAU,KAAK;AAAA,UACf,WAAW,KAAK,WAAW,qBAAqB,KAAK,SAAS;AAAA,UAC9D,WAAW,KAAK,aAAa;AAAA,UAC7B,UAAU,MAAM,YAAY,KAAK,YAAY;AAAA,SAC7C;AAED,YAAI,OAAO;AACVD,wBAAAA,MAAA,MAAA,SAAA,oCAAc,iBAAiB,KAAK;AAAA,QAErC;AAAA,MACC,SAAO,KAAK;AACbA,sBAAAA,MAAA,MAAA,SAAA,oCAAc,aAAa,GAAG;AAAA,MAC/B;AAEAA,oBAAG,MAAC,UAAU,EAAE,OAAO,OAAO,MAAM,WAAW;AAAA,IAC/C;AAAA,IACD,YAAY;AACX,YAAM,KAAK,SAAS,KAAK,OAAQ,EAAC,SAAS,EAAE,EAAE,MAAM,GAAG,EAAE,CAAC;AAC3D,WAAK,SAAS;AACd,aAAO;AAAA,IACP;AAAA,IACD,cAAc;AACb,WAAK,mBAAmB;AACxB,WAAK,qBAAqB;AAAA,QACzB,EAAE,MAAM,UAAU,MAAM,KAAM;AAAA,QAC9B,EAAE,MAAM,QAAQ,MAAM,SAAS;AAAA,MAChC;AACA,WAAK,kBAAkB;AAAA,IACvB;AAAA,IACD,mBAAmB,OAAO;AACzB,YAAM,SAAS,KAAK,mBAAmB,KAAK;AAC5C,UAAI,OAAO,SAAS,MAAM;AACzB,aAAK,YAAY;AACjB,aAAK,iBAAiB;AAAA,MACvB,WAAW,OAAO,SAAS,UAAU;AAEpC,aAAK,kBAAkB;AAAA,MACxB,WAAW,OAAO,SAAS,UAAU;AACpC,aAAK,sBAAsB;AAAA,iBACjB,OAAO,SAAS,QAAQ;AAClC,aAAK,iBAAiB;AACtB,aAAK,gBAAgB;AAAA,MACtB;AAAA,IACA;AAAA,IACD,oBAAoB;AACnB,WAAK,mBAAmB;AACxB,WAAK,qBAAqB;AAAA,QACzB;AAAA,UACC,MAAM,KAAK,iBAAiB,UAAU;AAAA,UACtC,MAAM;AAAA,UACN,QAAQ,KAAK,kBAAkB;AAAA,QAC/B;AAAA,QACD,EAAE,MAAM,QAAQ,MAAM,OAAO;AAAA,MAC9B;AAAA,IAEA;AAAA,IACD,mBAAmB;AAClB,WAAK,kBAAkB;AACvB,WAAK,mBAAmB;AACxB,WAAK,qBAAqB,CAAC;AAAA,IAC3B;AAAA,IACD,cAAc;AAEb,WAAK,mBAAmB;AAAA,IAKxB;AAAA;AAAA,IAED,MAAM,qBAAqB;AAC1B,UAAI;AACH,cAAM,UAAU,MAAM,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtDA,wBAAAA,MAAI,eAAe;AAAA,YAClB,MAAM;AAAA,YACN,SAAS,CAAC,QAAQ,QAAQ,IAAI,YAAY,CAAA,CAAE;AAAA,YAC5C,MAAM;AAAA,WACN;AAAA,SACD;AAED,cAAM,SAAS,MAAM,KAAK,eAAe;AACzC,aAAK,WAAW;AAEhB,aAAK,SAAS;AACd,aAAK,WAAW,QAAQ,YAAY,KAAK;AACzC,aAAK,SAAS,QAAQ,aAAa,KAAK;AACxC,aAAK,YAAY;AAEjB,cAAM,KAAK,SAAS,EAAE,UAAU,QAAQ;AACxC,aAAK,iBAAiB;AACtBA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,WAAW;AAAA,MAC/C,SAAO,KAAK;AACbA,sBAAAA,MAAc,MAAA,SAAA,oCAAA,UAAU,GAAG;AAC3BA,sBAAAA,MAAI,UAAU;AAAA,UACb,QAAO,2BAAK,WAAU;AAAA,UACtB,MAAM;AAAA,SACN;AAAA,MACF;AAAA,IACA;AAAA;AAAA,IAED,cAAc;AACb,aAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAEvC,YAAI,CAACE,cAAE,KAAC,OAAO;AACd,iBAAO,IAAI,MAAM,eAAe,CAAC;AACjC;AAAA,QACD;AACAA,sBAAE,KAAC,MAAM,aAAa;AAAA,UACrB,MAAM;AAAA,UACN,SAAS,CAAC,QAAQ;;AACjB,kBAAM,UAAS,gCAAK,WAAL,mBAAa;AAC5B,gBAAI;AAAQ,sBAAQ,MAAM;AAAA;AACrB,qBAAO,IAAI,MAAM,aAAa,CAAC;AAAA,UACpC;AAAA,UACD,MAAM;AAAA,SACN;AAAA,OAKD;AAAA,IACD;AAAA;AAAA,IAED,MAAM,iBAAiB;AACtB,UAAI,KAAK;AAAU,eAAO,KAAK;AAC/B,UAAI;AACH,cAAM,SAAS,MAAM,KAAK,YAAY;AACtC,aAAK,WAAW;AAChB,aAAK,SAAS;AACd,aAAK,YAAY;AACjBF,4BAAI,eAAe,YAAY,MAAM;AACrC,eAAO;AAAA,MACN,SAAO,KAAK;AAEbA,sBAAAA,MAAA,MAAA,QAAA,oCAAa,0BAA0B,GAAG;AAC1C,aAAK,YAAY;AACjB,eAAO;AAAA,MACR;AAAA,IACA;AAAA,IACD,eAAe;AAAA,IAEd;AAAA,IACD,MAAM,wBAAwB;AAC7BA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,QACP,UAAU,CAAC,YAAY;AAAA,QACvB,YAAY,CAAC,OAAO;AAAA,QACpB,SAAS,OAAO,QAAQ;AACvB,cAAI,IAAI,iBAAiB,IAAI,cAAc,SAAS,GAAG;AACtD,iBAAK,iBAAiB,IAAI,cAAc,CAAC;AACzC,iBAAK,SAAS,IAAI,cAAc,CAAC;AAEjC,iBAAK,kBAAkB;AAEvB,gBAAI,KAAK,UAAU;AAClB,oBAAM,SAAS,MAAM,KAAK,eAAe;AACzC,kBAAI,QAAQ;AACX,qBAAK,SAAS;AACd,qBAAK,YAAY;AAAA,qBACX;AACN,qBAAK,YAAY;AAAA,cAClB;AACA,oBAAM,KAAK,SAAS,EAAE,UAAU,UAAU,MAAM;AAChD,mBAAK,iBAAiB;AAAA,mBAChB;AAENA,4BAAG,MAAC,UAAU,EAAE,OAAO,eAAe,MAAM,QAAQ;AAAA,YACrD;AAAA,UACD;AAAA,QACD;AAAA,OACA;AAAA,IACD;AAAA,IACD,iBAAiB;AAChB,WAAK,gBAAgB;AACrB,WAAK,YAAY;AAAA,IACjB;AAAA,IACD,MAAM,mBAAmB;AACxB,UAAI,CAAC,KAAK,UAAU,QAAQ;AAC3BA,sBAAG,MAAC,UAAU,EAAE,OAAO,SAAS,MAAM,QAAQ;AAC9C;AAAA,MACD;AACA,WAAK,WAAW,KAAK,UAAU,KAAK;AAEpC,YAAM,SAAS,MAAM,KAAK,eAAe;AACzC,UAAI,QAAQ;AACX,aAAK,SAAS;AACd,aAAK,YAAY;AAAA,aACX;AACN,aAAK,YAAY;AAAA,MAClB;AAEA,UAAI,KAAK,gBAAgB;AACxB,aAAK,SAAS,KAAK;AACnB,cAAM,KAAK,SAAS,EAAE,UAAU,UAAU,MAAM;AAAA,aAC1C;AAENA,sBAAG,MAAC,UAAU,EAAE,OAAO,eAAe,MAAM,QAAQ;AAEpD,aAAK,kBAAkB;AACvB,aAAK,kBAAkB;AAAA,MACxB;AACA,WAAK,eAAe;AAAA,IACpB;AAAA,IACD,MAAM,YAAY;AACjB,UAAI,CAAC,KAAK;AAAQ;AAClB,YAAM,EAAE,MAAM,MAAM,IAAI,MAAMG,qBAAAA,kBAAkB,aAAa,KAAK,MAAM;AACxE,UAAI,CAAC,SAAS,MAAM;AACnB,aAAK,QAAQ;AAAA,MACd;AAAA,IACA;AAAA,IACD,MAAM,cAAc;AACnB,UAAI,CAAC,KAAK;AAAQ;AAClB,YAAM,EAAE,MAAM,UAAU,MAAMA,qBAAiB,kBAAC,gBAAgB,KAAK,QAAQ,CAAC;AAC9E,UAAI,CAAC,SAAS,MAAM;AACnB,aAAK,UAAU,KAAK,IAAI,QAAM;AAAA,UAC7B,GAAG;AAAA,UACH,YAAa,EAAE,SAAS,EAAE,MAAM,SAAU,EAAE,eAAe,EAAE,WAAW;AAAA,QACzE,EAAE;AAAA,MACH;AAAA,IACA;AAAA,IACD,kBAAkB,KAAK;AACtB,YAAM,UAAU,IAAI,YAAY,IAAI;AACpC,UAAI,CAAC,SAAS;AACbH,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,QAAQ;AAC/C;AAAA,MACD;AACAA,oBAAG,MAAC,WAAW,EAAE,KAAK,2BAA2B,OAAO,IAAI;AAAA,IAC5D;AAAA,IACD,gBAAgB;AACfA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,SAAS;AAEjBA,0BAAG,MAAC,kBAAkB,QAAQ;AAC9BA,0BAAG,MAAC,kBAAkB,UAAU;AAChCA,0BAAG,MAAC,kBAAkB,YAAY;AAClCA,0BAAG,MAAC,kBAAkB,WAAW;AACjCA,0BAAG,MAAC,kBAAkB,UAAU;AAEhC,iBAAK,SAAS;AACd,iBAAK,WAAW;AAChB,iBAAK,WAAW;AAChB,iBAAK,SAAS;AACd,iBAAK,iBAAiB;AACtB,iBAAK,YAAY;AACjB,iBAAK,QAAQ;AAAA,cACZ,YAAY;AAAA,cACZ,cAAc;AAAA,cACd,aAAa;AAAA,cACb,cAAc;AAAA,YACf;AACA,iBAAK,UAAU,CAAC;AAEhB,iBAAK,YAAY;AACjBA,0BAAG,MAAC,UAAU,EAAE,OAAO,aAAa,MAAM,WAAW;AAAA,UACrD;AAAA,QACD;AAAA,OACA;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvaA,GAAG,WAAW,eAAe;"}